import{LegacyText,DOS437En,ISO88591,Win1252EN}from"./module/text.js";(()=>{const n="retrotxt-active",e="retrotxt-font-amiga",s="retrotxt-font-msdos",o="retrotxt-font-windows",i="textAmiga",a="textMSDOS",r="textWin9x",c="textWrap",d="textUnicode",l="retrotxtWrap",m="pre-wrap",u=document.getElementById("retrotxtCanvas");if(null!==u&&0!==u.textContent.trim().length){const t=document.getElementsByTagName("head");if(0!==t.length){const g=u.textContent,p=u.parentNode;const h=new class{constructor(t=""){this.set=t}css(){const t=document.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href","/static/retrotxt/css/retrotxt.css"),t}links(){const t=document.createElement("p");return t.setAttribute("id","retrotxtLinks"),t}amiga(){const t=document.createElement("a");return t.setAttribute("id",i),t.textContent="Amiga",t.addEventListener("click",()=>{this._activeLink(i),this._activeInfo(i),this._amigaToggle()}),t}msdos(){const t=document.createElement("a");return t.setAttribute("id",a),t.textContent="MS-DOS",t.addEventListener("click",()=>{this._activeLink(a),this._activeInfo(a),this._msdosToggle()}),t}win9x(){const t=document.createElement("a");return t.setAttribute("id",r),t.textContent="Windows",t.addEventListener("click",()=>{this._activeLink(r),this._activeInfo(r),this._win9xToggle()}),t}wrap(){const t=document.createElement("a");return t.textContent="Wrapped",t.setAttribute("id",c),t.setAttribute("class",n),t.addEventListener("click",t=>{this._wrapToggle(t.target)}),t.addEventListener("mouseover",()=>{t.classList.contains(n)?u.style.whiteSpace="pre":u.style.whiteSpace=`${m}`}),t.addEventListener("mouseleave",()=>{t.classList.contains(n)?u.style.whiteSpace=`${m}`:u.style.whiteSpace="pre"}),t}unicode(){const t=document.createElement("a");return t.setAttribute("id",d),t.textContent="Unicode",t.addEventListener("click",()=>{this._activeLink(d),this._activeInfo(d),this._unicodeToggle()}),t}_activeInfo(t=""){const e=document.createElement("a"),n=document.getElementById("retrotxtStatus");for(;n.firstChild;)n.removeChild(n.firstChild);var s=(()=>{switch(t){case i:return"ISO-8895-1";case a:return"CP-437";case r:return"Windows-1252";case d:return"";default:throw new Error(`Unknown active info ID: "${t}"`)}})();switch(t){case d:return void n.append(" ");case i:e.setAttribute("href","https://github.com/rewtnull/amigafonts/"),e.append("Topaz font by dMG");break;case a:case r:e.setAttribute("href","https://int10h.org/oldschool-pc-fonts/"),e.append("VGA font by VileR");break;default:throw new Error(`Unknown active info ID: "${t}"`)}const o=document.createElement("a");o.setAttribute("href","https://retrotxt.com"),o.append("RetroTxt"),n.append(s," encoding; ",e,", code: ",o,".")}_activeLink(e=""){const t=document.getElementById("retrotxtLinks").childNodes;t.forEach(t=>{t.id!==c&&t.nodeType===Node.ELEMENT_NODE&&(t.classList.remove(n),t.id===e&&t.classList.add(n))})}_amigaToggle(){u.classList.remove(s,o),u.classList.add(e);const t=new LegacyText(`${g}`,{codepage:ISO88591});u.textContent=t.normalize()}_msdosToggle(){u.classList.remove(e,o),u.classList.add(s);const t=new LegacyText(`${g}`,{codepage:DOS437En,displayControls:!0});u.textContent=t.normalize()}_wrapToggle(t){if((t=void 0===t?document.getElementById(c):t).classList.contains(n))return this._wrapOff(t,!0);this._wrapOn(t,!0)}_wrapOff(t,e){void 0===t&&(t=document.getElementById(c)),u.style.whiteSpace="pre",t.classList.remove(n),e&&localStorage.setItem(l,"false")}_wrapOn(t,e){void 0===t&&(t=document.getElementById(c)),u.style.whiteSpace=`${m}`,t.classList.add(n),e&&localStorage.removeItem(l)}_win9xToggle(){u.classList.remove(e,s),u.classList.add(o);const t=new LegacyText(`${g}`,{codepage:Win1252EN});u.textContent=t.normalize()}_unicodeToggle(){u.classList.remove(s,e,o),u.textContent=g}};t[0].append(h.css());const x=h.links();x.append("View text as: ",h.unicode(),h.msdos(),h.amiga(),h.win9x(),h.wrap()),p.insertBefore(x,u);const w=document.createElement("p");w.setAttribute("id","retrotxtStatus"),p.append(w),"false"===localStorage.getItem(l)&&h._wrapOff(void 0,!0),(u.classList.contains("retrotxt-msdos")?h.msdos():u.classList.contains("retrotxt-amiga")?h.amiga():u.classList.contains("retrotxt-windows")?h.win9x():h.unicode()).click()}}})();
/*! RetroTxt for Demozoo v1.0.0 (2021-06-24); © Ben Garrett - LGPL-3.0 */
